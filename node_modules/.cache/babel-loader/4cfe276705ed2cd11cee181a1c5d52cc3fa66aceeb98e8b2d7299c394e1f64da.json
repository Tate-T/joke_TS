{"ast":null,"code":"import _toConsumableArray from\"/Users/tetiana.tarasovych/Desktop/jokes_type-script/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"/Users/tetiana.tarasovych/Desktop/jokes_type-script/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/tetiana.tarasovych/Desktop/jokes_type-script/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{createAsyncThunk,createSlice}from'@reduxjs/toolkit';import axios from'axios';export var requestJokes=createAsyncThunk('jokes/get',/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(_,thunkApi){var _yield$axios$get,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('https://official-joke-api.appspot.com/jokes/ten');case 2:_yield$axios$get=_context.sent;data=_yield$axios$get.data;return _context.abrupt(\"return\",data);case 5:case\"end\":return _context.stop();}},_callee);}));return function(_x,_x2){return _ref.apply(this,arguments);};}());export var requestRefreshJokes=createAsyncThunk('jokes/refresh',/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(_,thunkApi){var _yield$axios$get2,data,jokes,jokesIds,hasDublicates;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.get('https://official-joke-api.appspot.com/jokes/ten');case 2:_yield$axios$get2=_context2.sent;data=_yield$axios$get2.data;jokes=thunkApi.getState().jokes.jokes;jokesIds=jokes.map(function(joke){return joke.id;});//['1' ,'2', '3'] -> {id: '3', ...}\nhasDublicates=!data.every(function(newJoke){return!jokesIds.includes(newJoke.id);});if(!hasDublicates){_context2.next=10;break;}thunkApi.dispatch(requestRefreshJokes());return _context2.abrupt(\"return\",thunkApi.rejectWithValue(false));case 10:return _context2.abrupt(\"return\",data);case 11:case\"end\":return _context2.stop();}},_callee2);}));return function(_x3,_x4){return _ref2.apply(this,arguments);};}());var initialState={jokes:[],favJokes:[],isLoading:false};var jokesSlice=createSlice({name:'jokes',initialState:initialState,reducers:{addJoke:function addJoke(state,_ref3){var payload=_ref3.payload;state.favJokes=[].concat(_toConsumableArray(state.favJokes),[payload]);},deleteJoke:function deleteJoke(state,_ref4){var payload=_ref4.payload;state.favJokes=state.favJokes.filter(function(joke){return joke.id!==payload.id;});}},extraReducers:function extraReducers(builder){return builder.addCase(requestJokes.pending,function(state){state.isLoading=true;}).addCase(requestJokes.fulfilled,function(state,action){state.isLoading=false;state.jokes=action.payload;}).addCase(requestRefreshJokes.fulfilled,function(state,action){state.isLoading=false;state.jokes=[].concat(_toConsumableArray(state.jokes),_toConsumableArray(action.payload));});}});var _jokesSlice$actions=jokesSlice.actions,addJoke=_jokesSlice$actions.addJoke,deleteJoke=_jokesSlice$actions.deleteJoke;export{addJoke,deleteJoke};export default jokesSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","axios","requestJokes","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_","thunkApi","_yield$axios$get","data","wrap","_callee$","_context","prev","next","get","sent","abrupt","stop","_x","_x2","apply","arguments","requestRefreshJokes","_ref2","_callee2","_yield$axios$get2","jokes","jokesIds","hasDublicates","_callee2$","_context2","getState","map","joke","id","every","newJoke","includes","dispatch","rejectWithValue","_x3","_x4","initialState","favJokes","isLoading","jokesSlice","name","reducers","addJoke","state","_ref3","payload","concat","_toConsumableArray","deleteJoke","_ref4","filter","extraReducers","builder","addCase","pending","fulfilled","action","_jokesSlice$actions","actions","reducer"],"sources":["/Users/tetiana.tarasovych/Desktop/jokes_type-script/src/redux/jokesReducer.ts"],"sourcesContent":["import {\n  createAsyncThunk,\n  createSlice,\n  PayloadAction,\n} from '@reduxjs/toolkit';\nimport axios from 'axios';\nimport { RootState } from './store';\n\nexport type Joke = {\n  id: number\n  type: string\n  setup: string\n  punchline: string\n};\n\ntype JokesState = {\n  favJokes: Joke[]\n  jokes: Joke[]\n  isLoading: boolean\n};\n\nexport const requestJokes = createAsyncThunk(\n  'jokes/get',\n  async (_, thunkApi) => {\n    const { data } = await axios.get<Joke[]>(\n      'https://official-joke-api.appspot.com/jokes/ten',\n    )\n    return data\n  },\n);\n\nexport const requestRefreshJokes = createAsyncThunk(\n  'jokes/refresh',\n  async (_, thunkApi) => {\n    const { data } = await axios.get<Joke[]>(\n      'https://official-joke-api.appspot.com/jokes/ten',\n    )\n    const jokes = (thunkApi.getState() as RootState).jokes.jokes as Joke[]\n    const jokesIds = jokes.map((joke) => joke.id) //['1' ,'2', '3'] -> {id: '3', ...}\n    const hasDublicates = !data.every(\n      (newJoke: Joke) => !jokesIds.includes(newJoke.id),\n    )\n\n    if (hasDublicates) {\n      thunkApi.dispatch(requestRefreshJokes())\n      return thunkApi.rejectWithValue(false)\n    }\n\n    return data\n  },\n);\n\nconst initialState: JokesState = {\n  jokes: [],\n  favJokes: [],\n  isLoading: false,\n};\n\nconst jokesSlice = createSlice({\n  name: 'jokes',\n  initialState,\n  reducers: {\n    addJoke: (state, { payload }: PayloadAction<Joke>) => {\n      state.favJokes = [...state.favJokes, payload]\n    },\n    deleteJoke: (state, { payload }: PayloadAction<Joke>) => {\n      state.favJokes = state.favJokes.filter((joke) => joke.id !== payload.id)\n    },\n  },\n  extraReducers: (builder) =>\n    builder\n      .addCase(requestJokes.pending, (state) => {\n        state.isLoading = true\n      })\n      .addCase(\n        requestJokes.fulfilled,\n        (state, action: PayloadAction<Joke[]>) => {\n          state.isLoading = false\n          state.jokes = action.payload\n        },\n      )\n      .addCase(\n        requestRefreshJokes.fulfilled,\n        (state, action: PayloadAction<Joke[]>) => {\n          state.isLoading = false\n          state.jokes = [...state.jokes, ...action.payload]\n        },\n      ),\n});\n\nexport const { addJoke, deleteJoke } = jokesSlice.actions;\nexport default jokesSlice.reducer;\n"],"mappings":"mbAAA,OACEA,gBAAgB,CAChBC,WAAW,KAEN,kBAAkB,CACzB,MAAO,CAAAC,KAAK,KAAM,OAAO,CAgBzB,MAAO,IAAM,CAAAC,YAAY,CAAGH,gBAAgB,CAC1C,WAAW,6BAAAI,IAAA,CAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CACX,SAAAC,QAAOC,CAAC,CAAEC,QAAQ,MAAAC,gBAAA,CAAAC,IAAA,QAAAN,mBAAA,GAAAO,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SAAAF,QAAA,CAAAE,IAAA,SACO,CAAAf,KAAK,CAACgB,GAAG,CAC9B,iDAAiD,CAClD,QAAAP,gBAAA,CAAAI,QAAA,CAAAI,IAAA,CAFOP,IAAI,CAAAD,gBAAA,CAAJC,IAAI,QAAAG,QAAA,CAAAK,MAAA,UAGLR,IAAI,0BAAAG,QAAA,CAAAM,IAAA,MAAAb,OAAA,GACZ,mBAAAc,EAAA,CAAAC,GAAA,SAAAnB,IAAA,CAAAoB,KAAA,MAAAC,SAAA,QACF,CAED,MAAO,IAAM,CAAAC,mBAAmB,CAAG1B,gBAAgB,CACjD,eAAe,6BAAA2B,KAAA,CAAAtB,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CACf,SAAAqB,SAAOnB,CAAC,CAAEC,QAAQ,MAAAmB,iBAAA,CAAAjB,IAAA,CAAAkB,KAAA,CAAAC,QAAA,CAAAC,aAAA,QAAA1B,mBAAA,GAAAO,IAAA,UAAAoB,UAAAC,SAAA,iBAAAA,SAAA,CAAAlB,IAAA,CAAAkB,SAAA,CAAAjB,IAAA,SAAAiB,SAAA,CAAAjB,IAAA,SACO,CAAAf,KAAK,CAACgB,GAAG,CAC9B,iDAAiD,CAClD,QAAAW,iBAAA,CAAAK,SAAA,CAAAf,IAAA,CAFOP,IAAI,CAAAiB,iBAAA,CAAJjB,IAAI,CAGNkB,KAAK,CAAIpB,QAAQ,CAACyB,QAAQ,EAAE,CAAeL,KAAK,CAACA,KAAK,CACtDC,QAAQ,CAAGD,KAAK,CAACM,GAAG,CAAC,SAACC,IAAI,QAAK,CAAAA,IAAI,CAACC,EAAE,GAAC,CAAC;AACxCN,aAAa,CAAG,CAACpB,IAAI,CAAC2B,KAAK,CAC/B,SAACC,OAAa,QAAK,CAACT,QAAQ,CAACU,QAAQ,CAACD,OAAO,CAACF,EAAE,CAAC,GAClD,KAEGN,aAAa,EAAAE,SAAA,CAAAjB,IAAA,WACfP,QAAQ,CAACgC,QAAQ,CAAChB,mBAAmB,EAAE,CAAC,QAAAQ,SAAA,CAAAd,MAAA,UACjCV,QAAQ,CAACiC,eAAe,CAAC,KAAK,CAAC,iBAAAT,SAAA,CAAAd,MAAA,UAGjCR,IAAI,2BAAAsB,SAAA,CAAAb,IAAA,MAAAO,QAAA,GACZ,mBAAAgB,GAAA,CAAAC,GAAA,SAAAlB,KAAA,CAAAH,KAAA,MAAAC,SAAA,QACF,CAED,GAAM,CAAAqB,YAAwB,CAAG,CAC/BhB,KAAK,CAAE,EAAE,CACTiB,QAAQ,CAAE,EAAE,CACZC,SAAS,CAAE,KACb,CAAC,CAED,GAAM,CAAAC,UAAU,CAAGhD,WAAW,CAAC,CAC7BiD,IAAI,CAAE,OAAO,CACbJ,YAAY,CAAZA,YAAY,CACZK,QAAQ,CAAE,CACRC,OAAO,CAAE,SAAAA,QAACC,KAAK,CAAAC,KAAA,CAAuC,IAAnC,CAAAC,OAAO,CAAAD,KAAA,CAAPC,OAAO,CACxBF,KAAK,CAACN,QAAQ,IAAAS,MAAA,CAAAC,kBAAA,CAAOJ,KAAK,CAACN,QAAQ,GAAEQ,OAAO,EAAC,CAC/C,CAAC,CACDG,UAAU,CAAE,SAAAA,WAACL,KAAK,CAAAM,KAAA,CAAuC,IAAnC,CAAAJ,OAAO,CAAAI,KAAA,CAAPJ,OAAO,CAC3BF,KAAK,CAACN,QAAQ,CAAGM,KAAK,CAACN,QAAQ,CAACa,MAAM,CAAC,SAACvB,IAAI,QAAK,CAAAA,IAAI,CAACC,EAAE,GAAKiB,OAAO,CAACjB,EAAE,GAAC,CAC1E,CACF,CAAC,CACDuB,aAAa,CAAE,SAAAA,cAACC,OAAO,QACrB,CAAAA,OAAO,CACJC,OAAO,CAAC5D,YAAY,CAAC6D,OAAO,CAAE,SAACX,KAAK,CAAK,CACxCA,KAAK,CAACL,SAAS,CAAG,IAAI,CACxB,CAAC,CAAC,CACDe,OAAO,CACN5D,YAAY,CAAC8D,SAAS,CACtB,SAACZ,KAAK,CAAEa,MAA6B,CAAK,CACxCb,KAAK,CAACL,SAAS,CAAG,KAAK,CACvBK,KAAK,CAACvB,KAAK,CAAGoC,MAAM,CAACX,OAAO,CAC9B,CAAC,CACF,CACAQ,OAAO,CACNrC,mBAAmB,CAACuC,SAAS,CAC7B,SAACZ,KAAK,CAAEa,MAA6B,CAAK,CACxCb,KAAK,CAACL,SAAS,CAAG,KAAK,CACvBK,KAAK,CAACvB,KAAK,IAAA0B,MAAA,CAAAC,kBAAA,CAAOJ,KAAK,CAACvB,KAAK,EAAA2B,kBAAA,CAAKS,MAAM,CAACX,OAAO,EAAC,CACnD,CAAC,CACF,EACP,CAAC,CAAC,CAEK,IAAAY,mBAAA,CAAgClB,UAAU,CAACmB,OAAO,CAA1ChB,OAAO,CAAAe,mBAAA,CAAPf,OAAO,CAAEM,UAAU,CAAAS,mBAAA,CAAVT,UAAU,CAAwB,OAAAN,OAAA,CAAAM,UAAA,EAC1D,cAAe,CAAAT,UAAU,CAACoB,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}